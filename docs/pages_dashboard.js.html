<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: pages/dashboard.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: pages/dashboard.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import Button from "@material-ui/core/Button"
import "../assets/css/styles.css"
import { navigate } from "gatsby"
import Adashblock from "../components/adashblock"
import Head from "../components/Head/Head"
import React, { useState } from "react"
import CheckCircleIcon from "@material-ui/icons/CheckCircle"
import axios from "axios"
import "react-phone-input-2/lib/style.css"
import ProgressBar from "../components/progress"
import { ToastContainer, toast } from "react-toastify"
import "react-toastify/dist/ReactToastify.css"
import * as path from "path"
import { v4 as uuidv4 } from "uuid"

if (typeof window !== "undefined") {
  //if there  are null values for answers in localstorage set it to empty strings
  if (localStorage.getItem("1") == null) {
    localStorage.setItem("1", "")
    localStorage.setItem("2", "")
    localStorage.setItem("3", "")
    localStorage.setItem("4", "")
    localStorage.setItem("5", "")
  }
} else {
  //console.log("we are running on the server")
}

/**
 * Functional component to display Customer Dashboard
 * @returns {JSX} 
 */
const Dashboard = () => {

  //Correct answers for questions
  let q1A = ["We are not concerned about employees leaving"]
  let q2A = ["They are sharing information perfectly"]
  let q3A = [
    "By enforcing vacations where the employee canâ€™t communicate with the company",
    "By moving employees to a different location where employee can communicate with company",
  ]
  let q4A = [
    "We train and motivate employees to share information",
    "We have processes and systems to share information",
    "We make knowledge sharing a part of the annual/quarterly evaluation process",
  ]

  //questions variables
  var q1
  var q2
  var q3
  var q4

  //state to store and set progress bar value
  const [completed, setCompleted] = useState(0)
  var comp = 0

  /**
   * Function to calculate score value for progress bar
   * @param {number} val 
   */
  const completedup = val => {
    comp = comp + val
    setCompleted(comp)
    if (comp > 96) {
      setCompleted(100)
    }
  }


  //store question value in variable to show on dashboard "More Details"
  if (typeof window !== "undefined") {
    q1 = localStorage.getItem("1").split(",").filter(Boolean)

    q2 = localStorage.getItem("2").split(",").filter(Boolean)

    q3 = localStorage.getItem("3").split(",").filter(Boolean)

    q4 = localStorage.getItem("4").split(",").filter(Boolean)
  }

  //Toast for please wait status
  const waittoast = () => {
    toast.success("Please wait!", {
      className: "custom-toast",
      draggable: "true",
      closeOnClick: "true",
      position: toast.POSITION.TOP_CENTER,
    })
  }

  //Toast for error status
  const errortoast = () => {
    toast.error("Something went Wrong!", {
      className: "custom-toast",
      draggable: "true",
      closeOnClick: "true",

      position: toast.POSITION.TOP_CENTER,
    })
  }

  /**
   * Function run when selecting a package. Passing selected package as parameter
   * Store data to dynamoDB through API call
   * @param {String} option Selected package option 
   */
  const selectOPtion = option => {
    let id = uuidv4()
    let user
    let questions
    let selectedPackage
    let config

    if (typeof window !== "undefined") {
      //store question from local storage
      let q1raw = localStorage.getItem("1").split(",").filter(Boolean)
      let q2raw = localStorage.getItem("2").split(",").filter(Boolean)
      let q3raw = localStorage.getItem("3").split(",").filter(Boolean)
      let q4raw = localStorage.getItem("4").split(",").filter(Boolean)
      let q5raw = localStorage.getItem("5").split(",").filter(Boolean)
      let q6raw = localStorage.getItem("6").split(",").filter(Boolean)
      let q7raw = localStorage.getItem("7").split(",").filter(Boolean)

      //set selected package in local storage
      localStorage.setItem("package", option)
      //set a unique id generated by uuid in local storage
      localStorage.setItem("id", id)

      //get current user, questoin and selected package
      user = JSON.parse(localStorage.getItem("user"))
      questions = { q1: q1raw, q2: q2raw, q3: q3raw, q4: q4raw, q5: q5raw, q6: q6raw, q7: q7raw }
      selectedPackage = localStorage.getItem("package")

      config = { questions: questions, selectedPackage: selectedPackage, score: completed }
    }

    //get date and time
    var datetime = new Date().toISOString();

    //data to be send to API
    let data = {
      id: id,
      createdAt: datetime,
      name: user.name,
      email: user.email,
      phone: user.phone,
      config: config,
    }

    //store data in localstorage
    if (typeof window !== "undefined") {
      localStorage.setItem("data", JSON.stringify(data))
    }

    //call an API post to a lamda function to store values in dynamoDB
    waittoast()
    return new Promise((resolve, reject) => {
      return axios
        .post(
          path.join(
            `https://63n876u8g1.execute-api.ap-south-1.amazonaws.com/dev/userdata/`,
            id
          ),
          data
        )
        .then(result => {
          resolve({ code: 200, message: result.data.message })
          navigate("/thanks")
        })
        .catch(err => {
          console.log("Failed", err)
          errortoast()
          reject({ code: 0, error: err })
        })
    })
  }

  //state variable to store value for show details button
  const [showDetail, setShowdetail] = useState(false)
  return (
    &lt;>
      &lt;Head />
      &lt;div className="container h-100">
        &lt;div className=" h-100">
          &lt;ToastContainer
            style={{ color: "white", fontWeight: "500", textAlign: "center" }}
          />
          &lt;div className="dashboard col-lg-12 mx-auto">
            &lt;h2 className="pricingTitle">
              Dashboard
              &lt;hr
                style={{
                  border: "4px solid #2F2E2E",
                  width: "7%",
                  borderRadius: "5px",
                }}
              />
            &lt;/h2>
            &lt;div className="mainQ" style={{ width: "inherit" }}>
              &lt;p
                style={{
                  fontWeight: "500",
                  fontSize: "25px",
                  marginTop: "20px",
                }}
              >
                Your Score
              &lt;/p>
              &lt;p
                style={{
                  fontWeight: "500",
                  fontSize: "40px",
                  color: completed > 70 ? "#1abc9c" : "#f1c40f",
                }}
              >
                {completed}%
              &lt;/p>
              &lt;ProgressBar bgcolor={"#1abc9c"} completed={completed} />
              &lt;p
                style={{
                  margin: "10",
                  backgroundColor: "rgba(255, 127, 80, 0.301)",
                  width: "fit-content",
                  padding: "7px",
                  fontWeight: "500",
                  cursor: "pointer",
                  display: !showDetail ? "inline-flex" : "none",
                }}
                onClick={() => setShowdetail(true)}
              >
                Show Details +
              &lt;/p>
              &lt;p
                style={{
                  margin: "10",
                  backgroundColor: "rgba(82, 82, 82, 0.301)",
                  width: "fit-content",
                  cursor: "pointer",
                  padding: "7px",
                  display: showDetail ? "inline-flex" : "none",
                }}
                onClick={() => setShowdetail(false)}
              >
                Hide Details -
              &lt;/p>
              &lt;div style={{ display: showDetail ? "block" : "none" }}>
                &lt;div className="qSection col-md-12 col-lg-6">
                  &lt;div className="questionBlock2">
                    &lt;h4>
                      When an employee leaves what is/are the biggest concern/s?
                    &lt;/h4>
                  &lt;/div>
                  &lt;div className="answerBlock">
                    {q1 &amp;&amp;
                      q1.map((object, index) => (
                        &lt;Adashblock
                          answers={object}
                          index={index}
                          correctA={q1A}
                          completed={completedup}
                        />
                      ))}
                  &lt;/div>
                &lt;/div>
                &lt;div className="qSection col-md-12 col-lg-6">
                  &lt;div className="questionBlock2">
                    &lt;h4>What prevents employees from sharing information?&lt;/h4>
                  &lt;/div>
                  &lt;div className="answerBlock">
                    {q2 &amp;&amp;
                      q2.map((object, index) => (
                        &lt;Adashblock
                          answers={object}
                          index={index}
                          correctA={q2A}
                          completed={completedup}
                        />
                      ))}
                  &lt;/div>
                &lt;/div>
                &lt;div className="qSection col-md-12 col-lg-6">
                  &lt;div className="questionBlock2">
                    &lt;h4>
                      How do you test how the company will function in the
                      absence of the key employee?
                    &lt;/h4>
                  &lt;/div>
                  &lt;div className="answerBlock">
                    {q3 &amp;&amp;
                      q3.map((object, index) => (
                        &lt;Adashblock
                          answers={object}
                          index={index}
                          correctA={q3A}
                          completed={completedup}
                        />
                      ))}
                  &lt;/div>
                &lt;/div>
                &lt;div className="qSection col-md-12 col-lg-6">
                  &lt;div className="questionBlock2">
                    &lt;h4>
                      What is being done by the company to ensure that knowledge
                      about company processes are shared?
                    &lt;/h4>
                  &lt;/div>
                  &lt;div className="answerBlock">
                    {q4 &amp;&amp;
                      q4.map((object, index) => (
                        &lt;Adashblock
                          answers={object}
                          index={index}
                          correctA={q4A}
                          completed={completedup}
                        />
                      ))}
                  &lt;/div>
                &lt;/div>
              &lt;/div>
            &lt;/div>
          &lt;/div>
          &lt;div className="mainPricing">
            &lt;h2 className="freepricingTitle text-center">
              What package you would like to go?
              &lt;hr
                style={{
                  border: "4px solid #2F2E2E",
                  width: "7%",
                  borderRadius: "5px",
                }}
              />
            &lt;/h2>

            &lt;div className="row h-100">
              &lt;div className="col-md-4 col-xl-4 mx-auto">
                &lt;div className="pricingBlock">
                  &lt;div
                    className="priceName"
                    style={{ backgroundColor: "#1ABC9C" }}
                  >
                    &lt;p className="priceType" style={{ marginBottom: "-10px" }}>
                      FREE
                    &lt;/p>
                    &lt;hr
                      style={{ width: "80%", border: "2px solid white" }}
                    >&lt;/hr>
                    &lt;p className="Pricevalue">$0&lt;/p>
                    &lt;p>per month&lt;/p>
                  &lt;/div>
                  &lt;div className="pBody my-auto">
                    &lt;div className="priceBody">
                      &lt;div style={{ display: "flex" }}>
                        &lt;CheckCircleIcon />
                        &lt;p>Free 30 min Consultation&lt;/p>
                      &lt;/div>
                      &lt;div style={{ display: "flex" }}>
                        &lt;CheckCircleIcon />{" "}
                        &lt;p>Discuss problems to work towards solutions&lt;/p>
                      &lt;/div>
                    &lt;/div>
                    &lt;div className="select">
                      &lt;center>
                        &lt;Button
                          className="site-btn login-btn freefix"
                          variant="contained"
                          onClick={() => {
                            selectOPtion("Free")
                          }}
                          size="small"
                          style={{
                            backgroundColor: "#1ABC9C",
                            color: "#ffffff",
                            fontSize: "15px",
                            fontWeight: "bold",
                          }}
                        // startIcon={&lt;DoneIcon />}
                        >
                          SELECT
                        &lt;/Button>
                      &lt;/center>
                    &lt;/div>
                  &lt;/div>
                &lt;/div>
              &lt;/div>
              &lt;div className="col-md-4 col-xl-4 mx-auto">
                &lt;div className="pricingBlock">
                  &lt;div
                    className="priceName"
                    style={{ backgroundColor: "#FF4F5A" }}
                  >
                    &lt;p className="priceType" style={{ marginBottom: "-10px" }}>
                      Professional
                    &lt;/p>
                    &lt;hr
                      style={{ width: "80%", border: "2px solid white" }}
                    >&lt;/hr>
                    &lt;p className="Pricevalue">$990&lt;/p>
                    &lt;p>per month&lt;/p>
                  &lt;/div>
                  &lt;div className="pBody my-auto">
                    &lt;div className="priceBody">
                      &lt;div style={{ display: "flex" }}>
                        &lt;CheckCircleIcon />
                        &lt;p>Lifetime access to course material&lt;/p>
                      &lt;/div>
                      &lt;div style={{ display: "flex" }}>
                        &lt;CheckCircleIcon />{" "}
                        &lt;p>
                          Weekly Zoom calls with the class to discuss issues
                        &lt;/p>
                      &lt;/div>
                      &lt;div style={{ display: "flex" }}>
                        &lt;CheckCircleIcon />{" "}
                        &lt;p>Interview with experts for live case studies&lt;/p>
                      &lt;/div>
                    &lt;/div>
                    &lt;div className="select">
                      &lt;center>
                        &lt;Button
                          className="site-btn login-btn freefix"
                          variant="contained"
                          onClick={() => {
                            selectOPtion("Professional")
                          }}
                          size="small"
                          style={{
                            backgroundColor: "#FF4F5A",
                            color: "#ffffff",
                            fontSize: "15px",
                            fontWeight: "bold",
                          }}
                        // startIcon={&lt;DoneIcon />}
                        >
                          SELECT
                        &lt;/Button>
                      &lt;/center>
                    &lt;/div>
                  &lt;/div>
                &lt;/div>
              &lt;/div>
              &lt;div className="col-md-4 col-xl-4 mx-auto">
                &lt;div className="pricingBlock">
                  &lt;div
                    className="priceName"
                    style={{ backgroundColor: "#F1C40F" }}
                  >
                    &lt;p className="priceType" style={{ marginBottom: "-10px" }}>
                      Starter
                    &lt;/p>
                    &lt;hr
                      style={{ width: "80%", border: "2px solid white" }}
                    >&lt;/hr>
                    &lt;p className="Pricevalue">$250&lt;/p>
                    &lt;p>per month&lt;/p>
                  &lt;/div>
                  &lt;div className="pBody my-auto">
                    &lt;div className="priceBody">
                      &lt;div style={{ display: "flex" }}>
                        &lt;CheckCircleIcon />
                        &lt;p>Workbook to build knowledge management plan&lt;/p>
                      &lt;/div>
                      &lt;div style={{ display: "flex" }}>
                        &lt;CheckCircleIcon />{" "}
                        &lt;p>Zoom recordings of interviews with experts&lt;/p>
                      &lt;/div>
                    &lt;/div>
                    &lt;div className="select">
                      &lt;center>
                        &lt;Button
                          className="site-btn login-btn freefix"
                          variant="contained"
                          onClick={() => {
                            selectOPtion("Starter")
                          }}
                          size="small"
                          style={{
                            backgroundColor: "#F1C40F",
                            color: "#ffffff",
                            fontSize: "15px",
                            fontWeight: "bold",
                          }}
                        // startIcon={&lt;DoneIcon />}
                        >
                          SELECT
                        &lt;/Button>
                      &lt;/center>
                    &lt;/div>
                  &lt;/div>
                &lt;/div>
              &lt;/div>
            &lt;/div>
          &lt;/div>
        &lt;/div>
      &lt;/div>
      &lt;div style={{ marginTop: "5em" }}>&lt;/div>
    &lt;/>
  )
}

export default Dashboard
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#Adashblock">Adashblock</a></li><li><a href="global.html#adminDash">adminDash</a></li><li><a href="global.html#Dashboard">Dashboard</a></li><li><a href="global.html#Home">Home</a></li><li><a href="global.html#ProgressBar">ProgressBar</a></li><li><a href="global.html#Qblock">Qblock</a></li><li><a href="global.html#Questions">Questions</a></li><li><a href="global.html#Register">Register</a></li><li><a href="global.html#Thanks">Thanks</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Thu May 06 2021 22:11:40 GMT+0530 (India Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
